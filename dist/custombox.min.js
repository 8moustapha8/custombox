/*
 *  Custombox v2.0.4 - 2014-11-19
 *  Modal Window Effects with transitions CSS3.
 *  http://dixso.github.io/custombox/
 *  (c) 2014 Julio de la Calle - @dixso9
 *
 *  Under MIT License - http://opensource.org/licenses/MIT
 */
var Custombox=function(){"use strict";var a={w:window,d:document,h:document.documentElement,create:document.createElement,settings:[],overlay:[],wrapper:[],container:[],modal:[],content:[],inline:[],size:[],close:[],open:[],scroll:[],item:-1},b={target:null,cache:!1,escKey:!0,zIndex:"auto",overlay:!0,overlayColor:"#000",overlayOpacity:.8,overlayClose:!0,overlaySpeed:300,overlayEffect:"auto",width:null,effect:"fadein",position:"center, center",animation:null,speed:500,open:null,complete:null,close:null},c={oldBrowser:navigator.appVersion.indexOf("MSIE 8.")>-1||navigator.appVersion.indexOf("MSIE 9.")>-1||/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent),overlay:{perspective:["letmein","makeway","slip"],together:["corner","slidetogether","scale","door","push","contentscale","simplegenie","slit","slip"]},modal:{position:["slide","flip","rotate"]}},d={init:function(){this.merge().built().check().binds()},merge:function(){return a.item++,a.settings.push(e.extend({},b,a.options)),delete a.options,"auto"===a.settings[a.item].overlayEffect&&(a.settings[a.item].overlayEffect=a.settings[a.item].effect),this},built:function(){var b=e.zIndex();if(a.h.classList.add("custombox-open","custombox-open-"+a.settings[a.item].overlayEffect),c.overlay.perspective.indexOf(a.settings[a.item].overlayEffect)>-1&&(a.scroll.push(a.h&&a.h.scrollTop||a.d.body&&a.d.body.scrollTop||0),a.h.classList.add("custombox-perspective"),a.w.scrollTo(0,0)),!a.main){for(a.main=a.create.call(a.d,"div");a.d.body.firstChild;)a.main.appendChild(a.d.body.firstChild);a.d.body.appendChild(a.main)}return"push"===a.settings[a.item].overlayEffect&&(a.main.style.transitionDuration=a.settings[a.item].speed+"ms"),a.main.classList.add("custombox-container","custombox-container-"+a.settings[a.item].overlayEffect),a.settings[a.item].overlay?(a.overlay.push(a.create.call(a.d,"div")),a.overlay[a.item].classList.add("custombox-overlay","custombox-overlay-"+a.settings[a.item].overlayEffect),a.overlay[a.item].style.zIndex=b+2,a.overlay[a.item].style.backgroundColor=a.settings[a.item].overlayColor,c.overlay.perspective.indexOf(a.settings[a.item].overlayEffect)>-1||c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1?a.overlay[a.item].style.opacity=a.settings[a.item].overlayOpacity:a.overlay[a.item].classList.add("custombox-overlay-default"),a.overlay[a.item].style.transitionDuration=c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1?a.settings[a.item].speed+"ms":a.settings[a.item].overlaySpeed+"ms",a.d.body.insertBefore(a.overlay[a.item],a.d.body.lastChild.nextSibling)):a.overlay.push(null),a.wrapper.push(a.create.call(a.d,"div")),a.wrapper[a.item].classList.add("custombox-modal-wrapper","custombox-modal-wrapper-"+a.settings[a.item].effect),a.wrapper[a.item].style.zIndex=b+3,a.d.body.insertBefore(a.wrapper[a.item],a.d.body.firstChild),a.container.push(a.create.call(a.d,"div")),a.container[a.item].classList.add("custombox-modal-container","custombox-modal-container-"+a.settings[a.item].effect),a.container[a.item].style.zIndex=b+4,c.modal.position.indexOf(a.settings[a.item].effect)>-1&&(a.settings[a.item].animation=null!==a.settings[a.item].animation?a.settings[a.item].animation.indexOf(",")>-1?a.settings[a.item].animation.split(","):[a.settings[a.item].animation]:"slide"===a.settings[a.item].effect?["top"]:"flip"===a.settings[a.item].effect?["horizontal"]:["bottom"]),a.modal.push(a.create.call(a.d,"div")),a.modal[a.item].classList.add("custombox-modal","custombox-modal-"+a.settings[a.item].effect+(c.modal.position.indexOf(a.settings[a.item].effect)>-1?"-"+a.settings[a.item].animation[0].trim():"")),a.modal[a.item].style.transitionDuration=a.settings[a.item].speed+"ms",a.modal[a.item].style.zIndex=b+4,a.wrapper[a.item].appendChild(a.container[a.item]).appendChild(a.modal[a.item]),this},check:function(){return"function"==typeof a.settings[a.item].open&&a.settings[a.item].open.call(),a.settings[a.item].position.indexOf(",")>-1?(a.settings[a.item].position=a.settings[a.item].position.split(","),"#"===a.settings[a.item].target.charAt(0)||"."===a.settings[a.item].target.charAt(0)&&"/"!==a.settings[a.item].target.charAt(1)?a.d.querySelector(a.settings[a.item].target)?(a.inline.push(a.create.call(a.d,"div")),a.content.push(a.d.querySelector(a.settings[a.item].target)),a.content[a.item].style.display="block",a.content[a.item].parentNode.insertBefore(a.inline[a.item],a.content[a.item]),this.size().open()):this.error():this.ajax()):this.error(),this},ajax:function(){var b=this,d=new XMLHttpRequest,e=a.create.call(a.d,"div");d.onreadystatechange=function(){4===d.readyState&&(200===d.status?(e.innerHTML=d.responseText,a.content.push(e),a.content[a.item].style.display="block",!/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent)&&c.oldBrowser?a.content[a.item].style.styleFloat="left":a.content[a.item].style.cssFloat="left",a.container[a.item].appendChild(a.content[a.item]),b.size().open()):b.error())},d.open("GET",a.settings[a.item].target+(a.settings[a.item].cache?"":"?_="+Date.now()),!0),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.send(null)},size:function(){{var b=a.content[a.item].offsetWidth;a.content[a.item].offsetHeight}if(a.inline[a.item]||(!/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent)&&c.oldBrowser?a.content[a.item].style.styleFloat="none":a.content[a.item].style.cssFloat="none"),isNaN(a.settings[a.item].width)||null===a.settings[a.item].width||(b=parseInt(a.settings[a.item].width,0)),a.size.push(b),a.size[a.item]+60>=a.w.innerWidth)a.container[a.item].style.width="auto",a.container[a.item].style.margin="5%",a.wrapper[a.item].style.width=a.w.innerWidth+"px";else{switch(a.settings[a.item].position[0].trim()){case"left":a.container[a.item].style.marginLeft=0;break;case"right":a.container[a.item].style.marginRight=0}a.container[a.item].style.width=a.size[a.item]+"px"}if(a.content[a.item].style.width="auto",a.modal[a.item].appendChild(a.content[a.item]),a.content[a.item].offsetHeight>=a.w.innerHeight)a.container[a.item].style.marginTop="5%",a.container[a.item].style.marginBottom="5%";else{var d;switch(a.settings[a.item].position[1].trim()){case"top":d=0;break;case"bottom":d=a.w.innerHeight-a.content[a.item].offsetHeight+"px";break;default:d=a.w.innerHeight/2-a.content[a.item].offsetHeight/2+"px"}a.container[a.item].style.marginTop=d}return this},open:function(){if(a.settings[a.item].overlay)if(c.overlay.perspective.indexOf(a.settings[a.item].overlayEffect)>-1||c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1?a.overlay[a.item].classList.add("custombox-overlay-open"):a.overlay[a.item].style.opacity=a.settings[a.item].overlayOpacity,a.main.classList.add("custombox-container-open"),c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1)a.wrapper[a.item].classList.add("custombox-modal-open");else{var b=function(){a.overlay[a.item].removeEventListener("transitionend",b),a.wrapper[a.item].classList.add("custombox-modal-open")};a.overlay[a.item].addEventListener("transitionend",b,!1)}else a.wrapper[a.item].classList.add("custombox-modal-open"),a.main.classList.add("custombox-container-open");return this},binds:function(){var b=this;a.settings[a.item].escKey&&(a.d.onkeydown=function(c){c=c||a.w.event,27===c.keyCode&&b.close()}),a.settings[a.item].overlayClose&&a.wrapper[a.item].addEventListener("click",function(c){c.target===a.wrapper[a.item]&&b.close()},!1),a.w.addEventListener("onorientationchange"in a.w?"orientationchange":"resize",function(){b.responsive()},!1);var d=function(){if(!a.inline[a.item])for(var b=0,c=a.modal[a.item].getElementsByTagName("script"),d=c.length;d>b;b++)new Function(c[b].text)();a.settings[a.item]&&"function"==typeof a.settings[a.item].complete&&a.settings[a.item].complete.call()},e=function(){d(),a.modal[a.item].removeEventListener("transitionend",e)};c.oldBrowser?d():"slit"!==a.settings[a.item].effect?a.modal[a.item].addEventListener("transitionend",e,!1):a.modal[a.item].addEventListener("animationend",e,!1)},close:function(){var b=function(){if(a.h.classList.remove("custombox-open-"+a.settings[a.item].overlayEffect),a.settings[a.item].overlay&&(a.overlay[a.item].classList.add("custombox-overlay-close"),a.overlay[a.item].style.opacity&&(a.overlay[a.item].style.opacity=0),a.overlay[a.item].classList.remove("custombox-overlay-open"),a.main.classList.remove("custombox-container-open")),c.oldBrowser||!a.overlay[a.item])d();else{var b=function(){a.overlay[a.item].removeEventListener("transitionend",b),d()};a.overlay[a.item].addEventListener("transitionend",b,!1)}},d=function(){if(a.item||(a.h.classList.remove("custombox-perspective","custombox-open"),"undefined"!=typeof a.scroll[a.item]&&a.w.scrollTo(0,a.scroll[a.item])),a.h.classList.remove("custombox-open-"+a.settings[a.item].overlayEffect),a.inline[a.item]&&(!/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent)&&c.oldBrowser?(a.content[a.item].removeAttribute("width"),a.content[a.item].removeAttribute("display")):(a.content[a.item].style.removeProperty("width"),a.content[a.item].style.removeProperty("display")),a.inline[a.item].parentNode.replaceChild(a.content[a.item],a.inline[a.item])),a.main.classList.remove("custombox-container-"+a.settings[a.item].overlayEffect),a.wrapper[a.item].parentNode.removeChild(a.wrapper[a.item]),a.settings[a.item].overlay&&a.overlay[a.item].parentNode.removeChild(a.overlay[a.item]),"function"==typeof a.settings[a.item].close&&a.settings[a.item].close.call(),!a.item){for(var b=a.d.querySelectorAll(".custombox-container > *"),d=0,e=b.length;e>d;d++)document.body.insertBefore(b[d],a.main);a.main.parentNode&&a.main.parentNode.removeChild(a.main)}a.wrapper.pop(),a.inline[a.item]&&a.inline.pop(),a.content.pop(),a.container.pop(),a.modal.pop(),a.overlay.pop(),a.size.pop(),a.settings.pop(),a.scroll.pop(),a.item--};if(c.modal.position.indexOf(a.settings[a.item].effect)>-1&&a.settings[a.item].animation.length>1&&(a.modal[a.item].classList.remove("custombox-modal-"+a.settings[a.item].effect+"-"+a.settings[a.item].animation[0]),a.modal[a.item].classList.add("custombox-modal-"+a.settings[a.item].effect+"-"+a.settings[a.item].animation[1].trim())),a.wrapper[a.item].classList.remove("custombox-modal-open"),c.oldBrowser||c.overlay.together.indexOf(a.settings[a.item].overlayEffect)>-1)b();else{var e=function(){a.wrapper[a.item].removeEventListener("transitionend",e),b()};a.wrapper[a.item].addEventListener("transitionend",e,!1)}},responsive:function(){for(var b,c=0,d=a.container.length;d>c;c++){if(a.size[c]+60>=a.w.innerWidth)a.container[c].style.width="auto",a.container[c].style.marginLeft="5%",a.container[c].style.marginRight="5%",a.wrapper[a.item].style.width=a.w.innerWidth+"px";else{switch(a.settings[a.item].position[0].trim()){case"left":a.container[c].style.marginLeft=0;break;case"right":a.container[c].style.marginRight=0;break;default:a.container[c].style.marginLeft="auto",a.container[c].style.marginRight="auto"}a.container[c].style.width=a.size[c]+"px",a.wrapper[a.item].style.width="auto"}if(a.content[c].offsetHeight>=a.w.innerHeight)a.container[c].style.marginTop="5%",a.container[c].style.marginBottom="5%";else{switch(a.settings[a.item].position[1]){case"top":b=0;break;case"bottom":b=a.w.innerHeight-a.content[c].offsetHeight+"px";break;default:b=a.w.innerHeight/2-a.content[c].offsetHeight/2+"px"}a.container[c].style.marginTop=b}}},error:function(){alert("Error to load this target: "+a.settings[a.item].target)}},e={zIndex:function(){window.getComputedStyle||(window.getComputedStyle=function(a){return this.el=a,this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;return"float"==b&&(b="styleFloat"),c.test(b)&&(b=b.replace(c,function(){return arguments[2].toUpperCase()})),a.currentStyle[b]?a.currentStyle[b]:null},this});var b=0;if(isNaN(a.settings[a.item].zIndex))for(var c=0,d=document.getElementsByTagName("*"),e=d.length;e>c;c+=1){var f=window.getComputedStyle(d[c]).getPropertyValue("z-index");f&&(f=+f,f>b&&(b=f))}else b=a.settings[a.item].zIndex;return b},extend:function(){for(var a=1,b=arguments.length;b>a;a++)for(var c in arguments[a])arguments[a].hasOwnProperty(c)&&(arguments[0][c]=arguments[a][c]);return arguments[0]}};return{open:function(b){a.options=b,d.init()},close:function(){d.close()}}}();